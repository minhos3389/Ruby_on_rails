## DB == 영구적으로 정보를 저장

```
제목, 내용을 저장할 TABLE(표) 필요
              +
입력할 정보를 테이블에 넣어주는 기능
```

Model(표) + create action(입력할 정보를 테이블에 넣어주는 기능)

```shell
# 모델 생성하기
rails g model 이름
```

```shell
# post이름의 모델을 생성하기
rails g model post
```

### db/migrate/에 file생긴 것을 확인할 수 있다.

```Ruby
class CreatePosts < ActiveRecord::Migrations[5.0]
    def change
        create_table :posts do |t|

            t.timestamps 
        end
    end
end
```

### 이 파일을 수정해서 테이블의 모양을 잡아보자.
#### id는 자동 생성되니, 제목과 내용을 적어줄 수 있도록 설정해보자.

- 테이블의 모양을 결정
```Ruby
# migrate/xxx_create_posts.rb 파일
class CreatePosts < ActiveRecord::Migration[5.1]
    def change
        create_table :posts do |t|

            t.string :title
            t.text :content

            t.timestamps
        end
    end
end
```

title은 string문자열로 받고 content내용은 text로 받았다.

### rake db:migrate  테이블의 모양을 확정
### rake db:drop 테이블을 삭제
```shell
# 테이블의 모양을 확정
rake db:migrate
# 테이블을 삭제
rake db:drop
```

## 테이블에 채워넣기
- create에 채워넣어야할 코드
```Ruby
def create
    # 테이블 한 행 추가 (테이블에 한 행을 새로 추가해서 정보를 받겠다.)
    @post = Post.new
    # post_title의 내용을 title행에 추가
    # params를 통해서 form태그안에 input 태그, textarea태그의 name 속성을 통해서 가져온다.
    @post.title = params[:post_title]
    # post_content의 내용을 content 행에 추가
    @post.content = params[:post_content]
    # 테이블에 써준 내용을 모두 저장
    @post.save

    # 저장 후 /home/index페이지로 돌아가서 전체 글목록을 확인하도록 한다.
    redirect_to '/home/index'
end
```

## 테이블 전체 불러오기
```Ruby
def index
    @posts = Post.all
end
```


### 이제 서버를 실행시키고 글을 3개 적어보도록 하자.
### 확인해 봐야 하는데 현재 페이지들로는 확인이 어렵다.
### rails c 명령을 통해서 콘솔창에서 DB의 정보를 확인 가능하다.

```shell
rails c
# Post라는 모델을 작성했는데 모든 게시물을 보여달라고 하기 위해
# Post.all 명령을 수행
Post.all
```
- 괄호의 차이점
`<%= 실행되는게 보인다.%>` <br>
`<% 안보인다.%>`

```html
<!-- x는 그냥 변수이므로 다른 이름도 사용가능하다. -->
<%@posts.each do |x|%>        <!-- x는 post테이블의 각 행 -->
    제목: <%=x.title%><br>    
    내용: <%=x.content%><br>
    -------------------<br>
<%end%>
```
- x는 그냥 변수이므로 다른 이름도 사용가능하다.
- x는 post테이블의 각 행을 의미한다.
- each문은 한 줄씩 불러와서 x에 담아 주는것이다.(반복문)
- 불러온 x 행의 title에 들어있는 내용
- 불러온 x 행의 content에 들어있는 내용
- 한 줄 씩 do~end 사이의 작업을 반복

[루비반복문참고](https://smartbase.tistory.com/52)