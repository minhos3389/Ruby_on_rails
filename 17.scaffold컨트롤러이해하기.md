# scaffold 컨트롤러 이해하기

## respond_to 
: 지정된 형식에 따라 템플릿을 다르게 출력(실행)하도록 하는 method



```Ruby
# controllers/concerns/posts_controller.rb의 create 액션을  예시로 보자.
def create
    @post = Post.new(post_params)

    # 지정된 형식에 따라 다른 템플릿을 출력
    respond_to do |format|
        if @post.save
            # 기본적인 형식은 html
            # @post.save 뒤, @post로 redirect 된다.
            format.html { redirect_to @post, notice: 'Post was successfully created.'}
            # json을 사용할 경우를 대비한 코드
            format.json { render :show, status :created, location: @post }
        else 
            format.html { render :new, stauts: :unprocessable_entity }
            format.json { render json: @post.errors, status: :unprocessable_entity }
        end
    end 
end
```

### HTML
: 일반적인 상황에서 사용 .html.erb: ruby 코드를 사용할 수 있는 html의 한 형태

### json
: 데이터의 표현 방법 중 하나 api 사용할 때 자주 등장


### 어쨌거나 지금 쓰는 건 HTML
: JSON은 잠시 잊도록 한다. <BR> 기억해야 할 건, `@post.save 뒤`에 `@post`로 `redirect` 된다는 것! <BR> ex) posts/3

게시물은 new에서 작성하게되면 create액션에서 그것을 저장한다. <br>
저장한 뒤 @post 게시글 하나로 이동을 하게된다. 우리가 만든 게시물 숏 페이지로 이동을 하게된다. url이 아니라고 생각할 수 있으나 게시물이 성공적으로 저장이되면 그 게시물로 이동하라라고 하는 것으로 이해하면 된다. 게시글을 저장하는 데 실패를 하면 new 액션을 띄워주게 된다.


## Strong Parameter
: 받고 싶은 것만 받자!(화이트 리스트 <=> 블랙 리스트) <br>
블랙리스트가 제외하는 명단이라면 화이트리스트는 받고 싶은 것만 받는 것이라고 생각하면 된다. 

```ruby
# controllers/concerns/posts_controller.rb의 하단 코드부분 참조
def post_params
    params.require(:post).permit(:title, :content)
end
```
일반유저는 지정된 속성만을 변경할 수 있어야 한다. <br>
게시물 작성시에도 제목과 내용만을 받으면 된다. <br>
무언가를 특정해서 받고 싶을 때, 화이트 리스트 작성 

- post_params 부분
> params.require(모델 이름).permit(:속성 1,:속성 2)

화이트리스트를 작성해주면 title과 content 만 작성할 수 있게해서 더 안전하게 params를 받을 수 있게 된다.

## flash
: redirect 전후로만 데이터를 저장하고 싶을 때 (일시적으로 보여주고 싶을 경우)<br>
새로고침하면 없어지는 데이터들. 현재 요청과 다음 요청에서만 정보를 저장한다. 다음과 같은 형식으로 사용한다.

> flash[:아무이름] = "넣고 싶은 메시지" 

`flash[:notice]`는 성공적일 때,  `flash[:alert]`는 경고, 실패했을 때 각각은 그냥 `notice`, `alert`로 사용할 수 있음(레일즈에서 정해놓음.)



