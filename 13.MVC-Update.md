# MVC-Update

### edit == 덮어쓰기
새 글을 쓰는게 빈 테이블을 만들고 내용을 채우는 과정이라면, 글을 수정하는 건 채워진 테이블의 내용을 바꾸는 것.

### 수정 페이지 양식 == 글 쓰기 양식
- edit.html.erb == new.html.erb
- 단, **이전 내용**을 불러와야 함
- 이전 내용정보를 사용자가 고칠 수 있도록 만들어 줘야한다.

### 수정하면서 id는 두 번 필요
#### 1. 수정하는 양식에 이전에 썼던 특정 내용을 불러올 때
#### 2. 이전 글을 수정한 뒤 새로운 내용으로 업데이트 할 때


- 이전 게시물의 id를 알아야, 내용과 제목을 수정하는 페이지에서 아이디를 통해서 게시물의 제목과 내용을 꺼내올 수 있다.
- id를 알아야 새로 수정페이지에서 게시물을 수정한 뒤 그 게시물을 업데이트 하는 과정에서 필요하다. 이전 게시물의 id를 알아야 새로 고친 내용을 이전 게시물에 적용할 수 있는 것이다. <br> 우리는 edit 페이지에서 게시물을 수정하고 그 수정 내용을 update action에서 적용하고, 다시 index 페이지로 돌아와 전체 목록을 보는 것이다.

### edit action으로 id 넘기기

```html
<%@posts.each do |p| %>
    제목: <%=x.title%><br><br>
    내용: <%=x.content%><br>
    <a href='/home/destroy/<%=p.id%>'>[삭제]</a>
    <!-- 수정 경로를 적어 줬다. -->
    <a href='/home/edit/<%=p.id%>'>[수정]</a>
    <br>
    ------------------------------<br>
<% end %>
```



```Ruby
# home_controller.rb
def edit
    @post = Post.find(params[:post_id])
end
```

```html
<!-- edit.html.erb파일 생성 -->
<h2>수정 페이지입니다!</h2>
<!-- update url로 이동 -->
<form action='/home/update/<%=@post.id%>' method='post'>
    <%= hidden_field_tag :authenticity_token, form_authenticity_token %>
    <!-- 이전 게시물을 @post에 저장해 두었으므로 이를 통해 내용과 제목을 넣는다. -->
    <!-- input 태그에서는 value를 이용해서 넣는다. -->
    제목: <input type="text" name="post_title" value='<%=@post.title%>'> <br>
    <!-- textarea 태그에서는 태그사이에 적어준다. -->
    내용: <textarea name="post_content"><%=@post.content%></textarea>
    <input type="submit" value="수정">
</form>
```
### update 액션추가

```Ruby
# home_controller.rb
def edit
    @post = Post.find(params[:post_id])
end

def update
    # post는 특정 게시물 하나를 담는 지역변수
    # @post안쓰는이유 view파일 따로 없으므로, view 파일 존재할 시 @post사용할 필요 있다. view파일에서도 사용하기 위함. ex) new와 edit 액션의 경우
    post = Post.find(params[:post_id])
    post.title = params[:post_title]
    post.content = params[:post_content]
    post.save

    # root 페이지로 이동
    redirect_to '/home/index'
end
```