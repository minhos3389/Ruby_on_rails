# MVC-Delete

## CRUD의 Delete기능 

### 전에 만들었던 create.html.erb 사실상 뷰파일은 볼 필요가 없다.
- why? : params를 통해서 어떻게 데이터가 전송되는지 확인하려고 했을뿐
- 실질적으로는 home컨트롤러의 create액션에서 정보를 보여주고 index액션으로 화면을 전송하기 때문에 굳이 view파일을 볼 필요가 없어 삭제. (굳이 view파일을 작성할 필요 X)

```Ruby
# routes.rb 파일
Rails.application.routes.draw do
    root "home#index"

    get 'home/index'

    get 'home/new'

    post 'home/create'

    # home#destroy 와 같은 의미
    get 'home/destroy'
end
```

컨트롤러에 destroy액션을 작성했다. <br>
하지만 문제점이 발생한다.

```Ruby
# home_controller.rb 파일
class HomeController < ApplicationController
    def index
        @posts = Post.all
    end

    def new
    end

    def create
        @post = Post.new
        @post.title = params[:post_title]
        @post.content = params[:post_content]
        @post.save

        redirect_to "/home/index"
    end

    # 문제의 destroy액션
    def destroy 
        Post.destroy_all
        redirect_to "/home/index"
    end
end
```


### 우리가 한 것 == "전체" 게시물의 삭제
### 원하는 것 == "특정" 게시물의 삭제 (개별적인 게시물의 삭제를 요구)

### id == 주민등록번호 와 같이 특정한 누군가를 나타내기 위한 수단으로 "id"를 필요로 한다. 

### id는 .save를 수행하면서 테이블에 자동으로 생성!!
### url로 destroy action에 id를 전달하도록 하자.

```html
<!-- index.html.erb파일 -->
<%@posts.each do |p|%>        <!-- x는 post테이블의 각 행 -->
    제목: <%=x.title%><br>    
    내용: <%=x.content%><br>
    <a href='/home/destroy/<%=p.id%>'>삭제</a><br>
    -------------------<br>
<%end%>
```

```Ruby
# routes.rb 수정

get 'home/destry/:post_id' => 'home#destry'
```

### /post_id 
- ```주소가 **문자 그대로**/post_id로 이동```

### /:post_id
- ```/destroy/1, /destory/2와 같이 게시물의 id를 post_id 변수에 저장```