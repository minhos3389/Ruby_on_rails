# form_for (뽐뽀)
```Ruby
# f의 변수명은 제한x , 그냥 "테이블 한줄"을 의미한다고 생각하면 된다.
<%=form_for(테이블 한 줄,url: posts_path, method:'post') do |f| %>
    <%=f.input 종류 %>
<% end %>
```

- form_tag와의 차이점이라면 뒤에 `|f|`가 붙는다는 것이다.
- f를 이용해서 `input`을 만들 것이다.


### 새로운 게시물을 만드는 경우를 살펴보자.

- 새로운 줄을 만들고, 앞으로의 정보를 `create action`에 넘겨줄 것이다.
```Ruby
# new.html.erb
# 새로 글을 작성하여 create action으로 보내기 위해 사용하는 코드
<%=form_for(Post.new, url:posts_path, method: 'post')do |f| %>
    <%=f.input종류%>
<%end%>
```

- 저장되어 있는 특정 id의 게시물을 찾아서 `update action`에 넘겨줄 것이다.
```Ruby
# 게시물이 이미 차있는 것을 찾아서 update action으로 보내기 위해사용하는 코드
<%=form_for(Post.find(3), url:post_path, method: 'patch')do |f| %>
    <%=f.input종류%>
<%end%>
```


```Ruby
# routes.rb 의 new action 
def new
    @post = Post.new
end
```
- 어떠한 내용을 담아서 `create action`으로 보내주겠다는 코드
```Ruby
# new.html.erb
<%=form_for(@post, url: posts_path, method: 'post') do |f| %>
    <%=f.label :title, '제목'%>
    <%=f.text_field :title %><br>

    <%=f.label :content, '내용'%>
    <%=f.text_area :content, %><br>
    
    <%=f.submit '제출' %>
<% end %>
```

### 주의할 점
: form_tag를 사용할 때는 input의 name을 마음대로 설정할 수 있었는데(다 params로 보낼 수 있었는데) <br> **form_for**는 모델과 관련되어 있는만큼 **모델과 관련된 속성만** `input의 이름`으로 지정을 할 수가 있다.<br> 즉, 그냥 title과 content로 써줘야 하는 것이다.

### create액션에서 redirect_to 를 실행시키지 않고, create.html.erb파일을 생성해 params를 살펴보자.
```Ruby
# create.html.erb
<%=params%>
```
### params를 살펴보면 이런식으로 두번 쌓여져 있는 것을 볼 수 있다.
> {"post"=>{"title"=>"title에 적은 값","content"=>"content에 적은 값"}}

### 따라서 create action에서도 params로 부터 데이터를 받기 위해서는 두번(괄호를) 까줘야한다.
```Ruby
# controller.rb
def create
    @post = Post.new
    @post.title = params[:post][:title]
    @post.content = params[:post][:title]
    @post.save

    redirect_to '/'
end
```
redirect_to 해제해주면 잘 작성되는 것 확인할 수 있다.



### edit.html.erb 파일에서 value를 작성하지 않더라고 기존의 url과 method방식 'patch'를 지정해주면 저장된 데이터를 잘 불러오는 것을 확인할 수 있다.
### url을 작성하지 않더라도 제대로 간다는 것을 확인할 수 있으나, 가독성을 위해 일단 적었다.

```Ruby
<%=form_for(@post, url:post_path, method: "patch") do |f| %>
    <%=f.label :title, '제목' %>
    <%=f.text_field :title%><br>

    <%=f.label :content, '내용'%>
    <%=f.text_area :content %><br>

    <%=f.submit '제출'%>
<%end%>
```



```Ruby
def update
    post = Post.find(params[:post_id])
    # post.title = params[:post_title]
    post.title = params[:post][:title]
    # post.content = params[:post_content]
    post.content = params[:post][:content]
    post.save 

    redirect_to "/home/index"
end
```

### edit.html.erb의 @post와 new.html.erb에서의 @post는 다르다는 것 주의!!


## 게시물이 차있느냐, 안차있느냐에 따라서 가게되는 경로가 달라진다는 것 중요